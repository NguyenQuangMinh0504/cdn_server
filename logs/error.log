2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:9: Host is saugau.com, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:12: {"host": "saugau.com", "ip": "104.154.99.60:80"}, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:13: saugau.com, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:14: 104.154.99.60:80, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header host: saugau.com;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept-encoding: gzip, deflate;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept-language: en-US,en;q=0.9;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header cookie: _ga=GA1.2.1797034747.1675767999; csrftoken=91KDPCqWtIA6ciLxaHddTatrzzqKpoIK;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header connection: keep-alive;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header cache-control: max-age=0;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header upgrade-insecure-requests: 1;, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:14 [error] 4801#1640108: *1 [lua] upstream.lua:21: 104.154.99.60:80, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "saugau.com"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:9: Host is saugau.com, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:12: {"host": "saugau.com", "ip": "104.154.99.60:80"}, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:13: saugau.com, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:14: 104.154.99.60:80, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept: */*;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header host: saugau.com;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept-encoding: identity;q=1, *;q=0;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header referer: http://saugau.com/;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header accept-language: en-US,en;q=0.9;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header range: bytes=376266-10485759;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header cookie: _ga=GA1.2.1797034747.1675767999; csrftoken=91KDPCqWtIA6ciLxaHddTatrzzqKpoIK;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header if-range: "644b9749-a0edbc";, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:19: Got header connection: keep-alive;, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/02 15:30:15 [error] 4801#1640108: *1 [lua] upstream.lua:21: 104.154.99.60:80, client: 127.0.0.1, server: , request: "GET /sample-mp4-file.mp4 HTTP/1.1", host: "saugau.com", referrer: "http://saugau.com/"
2023/05/10 09:20:42 [error] 10224#58640: *1 kevent() reported that connect() failed (61: Connection refused) while connecting to upstream, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", upstream: "http://[::1]:8082/", host: "localhost:8000"
2023/05/10 09:20:42 [warn] 10224#58640: *1 upstream server temporarily disabled while connecting to upstream, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", upstream: "http://[::1]:8082/", host: "localhost:8000"
2023/05/10 09:21:08 [notice] 10224#58640: *1 "^/something/newurl/(.*)$" does not match "/something.png", client: 127.0.0.1, server: , request: "GET /something.png?foo HTTP/1.1", host: "localhost:8000"
2023/05/10 09:21:08 [error] 10224#58640: *1 lua entry thread aborted: runtime error: ...Desktop/PROJECT/solo-projects/cdn_server/rewrite_url.lua:1: variable "x_upstream_request_uri" not found for writing; maybe it is a built-in variable that is not changeable or you forgot to use "set $x_upstream_request_uri '';" in the config file to define it first
stack traceback:
coroutine 0:
	[C]: in function 'error'
	...ew/Cellar/openresty/1.21.4.1_1/lualib/resty/core/var.lua:144: in function '__newindex'
	...Desktop/PROJECT/solo-projects/cdn_server/rewrite_url.lua:1: in main chunk, client: 127.0.0.1, server: , request: "GET /something.png?foo HTTP/1.1", host: "localhost:8000"
2023/05/15 22:37:17 [error] 25806#145130: *4 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:17 [error] 25806#145130: *4 attempt to send data on a closed socket: u:00000001047F4200, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:17 [error] 25806#145130: *4 attempt to send data on a closed socket: u:00000001047F4200, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:17 [error] 25806#145130: *4 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:17 [error] 25806#145130: *4 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:17 [error] 25806#145130: *5 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:17 [error] 25806#145130: *5 attempt to send data on a closed socket: u:000000010481B898, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:17 [error] 25806#145130: *5 attempt to send data on a closed socket: u:000000010481B898, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:17 [error] 25806#145130: *5 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:17 [error] 25806#145130: *5 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *8 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *8 attempt to send data on a closed socket: u:000000010482B088, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *8 attempt to send data on a closed socket: u:000000010482B088, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *8 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *8 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *9 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *9 attempt to send data on a closed socket: u:000000010481F570, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *9 attempt to send data on a closed socket: u:000000010481F570, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *9 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *9 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *12 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *12 attempt to send data on a closed socket: u:0000000104819B50, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *12 attempt to send data on a closed socket: u:0000000104819B50, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *12 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *12 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:18 [error] 25806#145130: *13 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *13 attempt to send data on a closed socket: u:0000000104676DD0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *13 attempt to send data on a closed socket: u:0000000104676DD0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *13 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:18 [error] 25806#145130: *13 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *16 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *16 attempt to send data on a closed socket: u:00000001047F2420, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *16 attempt to send data on a closed socket: u:00000001047F2420, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *16 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *16 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *17 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *17 attempt to send data on a closed socket: u:0000000104825A40, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *17 attempt to send data on a closed socket: u:0000000104825A40, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *17 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *17 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *20 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *20 attempt to send data on a closed socket: u:000000010480A440, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *20 attempt to send data on a closed socket: u:000000010480A440, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *20 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *20 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *21 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *21 attempt to send data on a closed socket: u:0000000104816DB8, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *21 attempt to send data on a closed socket: u:0000000104816DB8, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *21 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *21 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *24 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *24 attempt to send data on a closed socket: u:000000010481E8D0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *24 attempt to send data on a closed socket: u:000000010481E8D0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *24 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *24 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET / HTTP/1.1", host: "localhost"
2023/05/15 22:37:19 [error] 25806#145130: *25 kevent() reported that connect() failed (61: Connection refused), client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *25 attempt to send data on a closed socket: u:00000001048261C0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *25 attempt to send data on a closed socket: u:00000001048261C0, c:0000000000000000, ft:0 eof:0, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *25 [lua] upstream.lua:12: nil, client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
2023/05/15 22:37:19 [error] 25806#145130: *25 invalid URL prefix in "https://", client: 127.0.0.1, server: , request: "GET /favicon.ico HTTP/1.1", host: "localhost", referrer: "http://localhost/"
